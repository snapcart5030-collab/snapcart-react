{"version":3,"file":"static/js/561.3af8911a.chunk.js","mappings":"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","sources":["components/SaveLocation.js","components/PcProfile.jsx","components/socket.js"],"sourcesContent":["import { useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useCookies } from \"react-cookie\";\r\nimport toast from \"react-hot-toast\";\r\n\r\nfunction SaveLocation() {\r\n  const [cookies] = useCookies([\"token\"]);\r\n  const [location, setLocation] = useState(\r\n    JSON.parse(localStorage.getItem(\"userLocation\")) || null\r\n  );\r\n\r\n  const saveUserLocation = () => {\r\n    if (!navigator.geolocation) {\r\n      toast.error(\"Geolocation not supported!\");\r\n      return;\r\n    }\r\n\r\n    navigator.geolocation.getCurrentPosition(\r\n      async (position) => {\r\n        try {\r\n          const { latitude, longitude } = position.coords;\r\n\r\n          // ğŸŒ Reverse geocoding using OpenStreetMap\r\n          const geoRes = await axios.get(\r\n            `https://nominatim.openstreetmap.org/reverse?lat=${latitude}&lon=${longitude}&format=json`\r\n          );\r\n\r\n          const address =\r\n            geoRes.data?.display_name ||\r\n            `Lat: ${latitude}, Lng: ${longitude}`;\r\n\r\n          // âœ… Save location to backend\r\n          await axios.post(\r\n            \"http://localhost:5030/auth/location\",\r\n            { latitude, longitude, address },\r\n            { headers: { Authorization: `Bearer ${cookies.token}` } }\r\n          );\r\n\r\n          // âœ… Save location locally (UI + localStorage)\r\n          const userLocation = { latitude, longitude, address };\r\n          setLocation(userLocation);\r\n          localStorage.setItem(\"userLocation\", JSON.stringify(userLocation));\r\n\r\n          toast.success(`ğŸ“ Location saved: ${address}`);\r\n        } catch (error) {\r\n          console.error(\"Location save error:\", error);\r\n          toast.error(\"Failed to fetch or save location\");\r\n        }\r\n      },\r\n      () => toast.error(\"âŒ Turn On Your Location access \")\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div style={{ marginTop: \"20px\" }}>\r\n      <button onClick={saveUserLocation} className=\"btn btn-primary\">\r\n        Save My Location\r\n      </button>\r\n\r\n      {/* âœ… Display saved location */}\r\n      {location && (\r\n        <div style={{ marginTop: \"15px\" }}>\r\n          <h5>ğŸ“ Your Saved Location:</h5>\r\n          <p>\r\n            <strong>Address:</strong> {location.address}\r\n            <br />\r\n            <strong>Latitude:</strong> {location.latitude}\r\n            <br />\r\n            <strong>Longitude:</strong> {location.longitude}\r\n          </p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default SaveLocation;\r\n","import { useAuth } from \"./AuthProvider\";\r\nimport { useNavigate, Link } from \"react-router-dom\";\r\nimport { unregisterUserSocket } from \"./socket\";\r\nimport axios from \"axios\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useCookies } from \"react-cookie\";\r\nimport {\r\n  MyOrders_Url,\r\n  OrderStatusById_Url,\r\n} from \"./Api_URL_Page\"; \r\nimport \"./PcProfile.css\";\r\nimport SaveLocation from \"./SaveLocation\";\r\n\r\nfunction PcProfile() {\r\n  const { user, logout } = useAuth();\r\n  const navigate = useNavigate();\r\n  const [cookies] = useCookies([\"token\"]);\r\n  const [deliveredCount, setDeliveredCount] = useState(0);\r\n\r\n  // Redirect to login if user not logged in\r\n  useEffect(() => {\r\n    if (!user) {\r\n      navigate(\"/login\"); // redirect to login page\r\n    }\r\n  }, [user, navigate]);\r\n\r\n  const handleLogout = () => {\r\n    if (user) {\r\n      unregisterUserSocket(user.email);\r\n      logout();\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const fetchDeliveredOrders = async () => {\r\n      if (!cookies.token) return;\r\n      try {\r\n        const res = await axios.get(MyOrders_Url(), {\r\n          headers: { Authorization: `Bearer ${cookies.token}` },\r\n        });\r\n\r\n        const deliveredOrders = await Promise.all(\r\n          res.data.map(async (order) => {\r\n            try {\r\n              const statusRes = await axios.get(OrderStatusById_Url(order._id));\r\n              if (statusRes.data.status === \"delivered\") return order;\r\n              return null;\r\n            } catch {\r\n              return null;\r\n            }\r\n          })\r\n        );\r\n\r\n        setDeliveredCount(deliveredOrders.filter(Boolean).length);\r\n      } catch (err) {\r\n        console.error(\"âŒ Error fetching delivered orders:\", err);\r\n      }\r\n    };\r\n    fetchDeliveredOrders();\r\n  }, [cookies]);\r\n\r\n  if (!user) return null; // wait for redirect\r\n\r\n  return (\r\n    <div className=\"my_pc_profile_12_main_wrapper\">\r\n      <div className=\"my_pc_profile_12_card\">\r\n        <div className=\"my_pc_profile_12_avatar\">\r\n          <img\r\n            src={`https://ui-avatars.com/api/?name=${user.username}&background=6a11cb&color=fff`}\r\n            alt=\"Profile\"\r\n          />\r\n        </div>\r\n\r\n        <h2 className=\"my_pc_profile_12_title\">{user.username}</h2>\r\n\r\n        <div className=\"my_pc_profile_12_info\">\r\n          <p><strong>ğŸ“§ Email:</strong> {user.email}</p>\r\n          <p><strong>ğŸ“± Mobile:</strong> {user.mobile || \"N/A\"}</p>\r\n        </div>\r\n\r\n        <div className=\"my_pc_profile_12_buttons\">\r\n          <button onClick={handleLogout} className=\"my_pc_profile_12_btn btn btn-danger logout\">ğŸšª Logout</button>\r\n          <Link to=\"/\" className=\"my_pc_profile_12_btn home\">ğŸ  Home</Link>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"my_pc_profile_12_summary\">\r\n        <h2 className=\"my_pc_profile_12_summary_title\">ğŸ“¦ Order Summary</h2>\r\n        <div className=\"my_pc_profile_12_summary_box\">\r\n          <div className=\"my_pc_profile_12_summary_icon\">âœ…</div>\r\n          <div className=\"my_pc_profile_12_summary_text\">\r\n            <h3>{deliveredCount}</h3>\r\n            <p>Delivered Orders</p>\r\n          </div>\r\n        </div>\r\n\r\n        <Link to=\"/previousorders\" className=\"my_pc_profile_12_summary_link\">\r\n          ğŸ” View All Delivered Orders\r\n        </Link>\r\n      </div>\r\n\r\n      <SaveLocation/>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default PcProfile;\r\n","import { io } from \"socket.io-client\";\r\n\r\nexport const socket = io(\"https://snapcart-usja.onrender.com\", {\r\n  transports: [\"websocket\", \"polling\"],\r\n});\r\n\r\n// âœ… Register user after login\r\nexport const registerUserSocket = (userEmail) => {\r\n  if (userEmail) {\r\n    socket.emit(\"register\", userEmail);\r\n    console.log(\"ğŸŸ¢ Registered socket for:\", userEmail);\r\n  }\r\n};\r\n\r\n// âœ… Unregister user on logout\r\nexport const unregisterUserSocket = (userEmail) => {\r\n  if (userEmail) {\r\n    socket.emit(\"unregister\", userEmail);\r\n    console.log(\"ğŸ”´ Unregistered socket for:\", userEmail);\r\n  }\r\n};\r\n"],"names":["cookies","useCookies","location","setLocation","useState","JSON","parse","localStorage","getItem","_jsxs","style","marginTop","children","_jsx","onClick","saveUserLocation","navigator","geolocation","getCurrentPosition","async","_geoRes$data","latitude","longitude","position","coords","address","axios","get","concat","data","display_name","post","headers","Authorization","token","userLocation","setItem","stringify","toast","success","error","console","className","user","logout","useAuth","navigate","useNavigate","deliveredCount","setDeliveredCount","useEffect","res","MyOrders_Url","deliveredOrders","Promise","all","map","OrderStatusById_Url","order","_id","status","_unused","filter","Boolean","length","err","fetchDeliveredOrders","src","username","alt","email","mobile","handleLogout","unregisterUserSocket","Link","to","SaveLocation","socket","io","transports","registerUserSocket","userEmail","emit","log"],"sourceRoot":""}