{"version":3,"file":"static/js/89.fbb4dbb7.chunk.js","mappings":"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","sources":["components/EmptyCart.jsx","components/CartPage.jsx"],"sourcesContent":["import { Link } from \"react-router-dom\";\r\nimport \"./EmptyCart.css\"; // We'll create this CSS\r\n\r\nfunction EmptyCart() {\r\n  return (\r\n    <div className=\"empty_cart_container\">\r\n      <div className=\"empty_cart_box\">\r\n        <img\r\n          src=\"/image/emptycart.jpg\"\r\n          alt=\"Empty Cart\"\r\n          className=\"empty_cart_img\"\r\n        />\r\n       \r\n         <h2>Your Cart is Empty</h2>\r\n        <div>Looks like you haven't added anything to your cart yet. </div>\r\n       \r\n        <Link to=\"/\" className=\"continue_shopping_btn\">\r\n          Continue Shopping\r\n        </Link>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default EmptyCart;\r\n","import { useEffect, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useCookies } from \"react-cookie\";\r\nimport { useCart } from \"./CartProvider\";\r\nimport axios from \"axios\";\r\nimport { toast } from \"react-hot-toast\"; // âœ… using react-hot-toast now\r\n\r\nimport BatteryError from \"./BatteryError\"; // âœ… import BatteryError\r\n\r\nimport {\r\n  Cart_Url,\r\n  AddToCart_Url,\r\n  RemoveFromCart_Url,\r\n  Orders_Url,\r\n  ConfirmOrder_Url,\r\n} from \"./Api_URL_Page\";\r\nimport EmptyCart from \"./EmptyCart\";\r\n\r\nfunction CartPage() {\r\n  const [cookies] = useCookies([\"token\"]);\r\n  const [loadingIds, setLoadingIds] = useState([]);\r\n  const navigate = useNavigate();\r\n  const [batteryLow, setBatteryLow] = useState(false); // track battery low\r\n  const [showBatteryError, setShowBatteryError] = useState(false); // show BatteryError component\r\n  const { cartItems, fetchCart, addToCart, removeFromCart, setCartItems } =\r\n    useCart();\r\n\r\n  useEffect(() => {\r\n    if (!cookies.token) {\r\n      toast.error(\"Please login first to access the cart.\", {\r\n        position: \"top-center\",\r\n      });\r\n      navigate(\"/login\");\r\n    } else {\r\n      fetchCart();\r\n    }\r\n  }, [cookies, navigate, fetchCart]);\r\n\r\n  const TOAST_ID = \"cart-toast\";\r\n\r\n  // âœ… Increase quantity\r\n  const increment = async (productId, productName) => {\r\n    setLoadingIds((prev) => [...prev, productId]);\r\n    try {\r\n      await axios.post(\r\n        AddToCart_Url(),\r\n        { productId, quantity: 1 },\r\n        { headers: { Authorization: `Bearer ${cookies.token}` } }\r\n      );\r\n\r\n      fetchCart();\r\n\r\n      toast.dismiss(TOAST_ID); // dismiss previous\r\n      toast.success(`${productName || \"Item\"} quantity increased!`, {\r\n        id: TOAST_ID,\r\n        position: \"bottom-right\",\r\n      });\r\n    } catch (err) {\r\n      console.error(err);\r\n      toast.dismiss(TOAST_ID);\r\n      toast.error(\"Failed to increase quantity.\", {\r\n        id: TOAST_ID,\r\n        position: \"bottom-right\",\r\n      });\r\n    }\r\n    setLoadingIds((prev) => prev.filter((id) => id !== productId));\r\n  };\r\n\r\n  // âœ… Remove item manually (Remove button)\r\n  const handleRemove = async (productId) => {\r\n    setLoadingIds((prev) => [...prev, productId]);\r\n    try {\r\n      await axios.post(\r\n        RemoveFromCart_Url(),\r\n        { productId },\r\n        { headers: { Authorization: `Bearer ${cookies.token}` } }\r\n      );\r\n      setCartItems((prev) => prev.filter((item) => item.productId !== productId));\r\n      toast.success(`Item removed from cart.`, { id: TOAST_ID, position: \"bottom-right\" });\r\n    } catch (err) {\r\n      console.error(err);\r\n      toast.error(\"Failed to remove item.\", { position: \"bottom-right\" });\r\n    }\r\n    setLoadingIds((prev) => prev.filter((id) => id !== productId));\r\n  };\r\n\r\n  // âœ… Place Order + Trigger Tracking API\r\n  // âœ… Place Order + Trigger Tracking API\r\nconst handleOrderNow = async () => {\r\n  // âœ… Check battery before order\r\n  if (\"getBattery\" in navigator) {\r\n    const battery = await navigator.getBattery();\r\n    if (battery.level <= 0.2) {\r\n      setBatteryLow(true);\r\n      setShowBatteryError(true);\r\n      toast.error(\"Battery < 20% â€” please charge your phone\", {\r\n        position: \"top-center\",\r\n      });\r\n      navigate(\"/batery\");\r\n      return;\r\n    } else {\r\n      setBatteryLow(false);\r\n      setShowBatteryError(false);\r\n    }\r\n  }\r\n\r\n  // âœ… Require at least 3 items in cart\r\n  if (cartItems.length < 3) {\r\n    return toast.error(\"Please add at least 3 items before Ordering.\", {\r\n      position: \"top-center\",\r\n    });\r\n  }\r\n\r\n  if (!(\"geolocation\" in navigator)) {\r\n    return toast.error(\"Geolocation is not supported in your browser.\", {\r\n      position: \"top-center\",\r\n    });\r\n  }\r\n\r\n  toast.loading(\"Fetching your location...\", { position: \"top-center\" });\r\n\r\n  navigator.geolocation.getCurrentPosition(\r\n    async (position) => {\r\n      toast.dismiss();\r\n      const { latitude, longitude } = position.coords;\r\n      const address = `Lat: ${latitude}, Lng: ${longitude}`;\r\n\r\n      try {\r\n        const res = await axios.post(\r\n          `${Orders_Url()}/checkout`,\r\n          { latitude, longitude, address },\r\n          { headers: { Authorization: `Bearer ${cookies.token}` } }\r\n        );\r\n\r\n        const order = res.data.order;\r\n        toast.success(\"âœ… Order placed successfully!\", {\r\n          position: \"top-center\",\r\n        });\r\n\r\n        setCartItems([]);\r\n        await axios.post(ConfirmOrder_Url(), {\r\n          orderId: order._id,\r\n          userEmail: order.userEmail,\r\n        });\r\n\r\n        localStorage.setItem(\"lastOrderId\", order._id);\r\n        navigate(\"/myorders\");\r\n      } catch (err) {\r\n        console.error(err);\r\n        toast.error(err.response?.data?.msg || \"Failed to place order.\", {\r\n          position: \"bottom-right\",\r\n        });\r\n      }\r\n    },\r\n    (error) => {\r\n      toast.dismiss();\r\n      if (error.code === error.PERMISSION_DENIED) {\r\n        toast.error(\"Please allow location access before placing the order.\", {\r\n          position: \"top-center\",\r\n        });\r\n      } else {\r\n        toast.error(\"Unable to fetch location. Please try again.\", {\r\n          position: \"top-center\",\r\n        });\r\n      }\r\n    }\r\n  );\r\n};\r\n\r\n\r\n  if (!cookies.token) return null;\r\n\r\n  return (\r\n    <div className=\" container-fluid mt-5\">\r\n      {cartItems.length === 0 ? (\r\n        <div> <EmptyCart/> </div>\r\n      ) : (\r\n        <table className=\"table\">\r\n           <h2>Your Carts</h2>\r\n          <thead>\r\n            <tr>\r\n              <th>Product</th>\r\n              <th>Image</th>\r\n              <th>Price</th>\r\n              <th>Quantity</th>\r\n              <th>Total</th>\r\n              <th>Action</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {cartItems.map((item) => (\r\n              <tr key={item.productId}>\r\n                <td>{item.productName}</td>\r\n                <td>\r\n                  <img\r\n                    src={item.productImage}\r\n                    alt={item.productName}\r\n                    style={{\r\n                      width: \"60px\",\r\n                      height: \"60px\",\r\n                      objectFit: \"cover\",\r\n                      borderRadius: \"8px\",\r\n                    }}\r\n                  />\r\n                </td>\r\n                <td>â‚¹{item.productPrice}</td>\r\n                <td>\r\n                  <div className=\"d-flex align-items-center\">\r\n                    <button\r\n                      onClick={() => handleRemove(item.productId)}\r\n                      disabled={loadingIds.includes(item.productId)}\r\n                      className={`btn btn-sm ${\r\n                        item.quantity === 1 ? \"btn-danger\" : \"btn-secondary\"\r\n                      }`}\r\n                    >\r\n                      {item.quantity === 1 ? \"ðŸ—‘\" : \"-\"}\r\n                    </button>\r\n\r\n                    <span className=\"mx-2\">\r\n                      {loadingIds.includes(item.productId) ? (\r\n                        <span className=\"spinner-border spinner-border-sm\"></span>\r\n                      ) : (\r\n                        item.quantity\r\n                      )}\r\n                    </span>\r\n\r\n                    <button\r\n                      className=\"btn btn-sm btn-secondary\"\r\n                      onClick={() => increment(item.productId)}\r\n                      disabled={loadingIds.includes(item.productId)}\r\n                    >\r\n                      +\r\n                    </button>\r\n                  </div>\r\n                </td>\r\n                <td>â‚¹{item.productPrice * item.quantity}</td>\r\n                <td>\r\n                  <button\r\n                    className=\"btn btn-sm btn-danger\"\r\n                    onClick={() => handleRemove(item.productId)}\r\n                    disabled={loadingIds.includes(item.productId)}\r\n                  >\r\n                    Remove\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      )}\r\n\r\n      {cartItems.length > 0 && (\r\n        <div className=\"mt-3\">\r\n          <button\r\n          style={{\r\n          background: \"#00b761\",\r\n        }}\r\n          \r\n          className=\"btn text-light \" onClick={handleOrderNow}>\r\n            Order Now <span className=\"text-light fw-bold\">{cartItems.length}</span> items\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default CartPage;\r\n"],"names":["_jsx","className","children","_jsxs","src","alt","Link","to","cookies","useCookies","loadingIds","setLoadingIds","useState","navigate","useNavigate","batteryLow","setBatteryLow","showBatteryError","setShowBatteryError","cartItems","fetchCart","addToCart","removeFromCart","setCartItems","useCart","useEffect","token","toast","error","position","TOAST_ID","handleRemove","async","prev","productId","axios","post","RemoveFromCart_Url","headers","Authorization","concat","filter","item","success","id","err","console","length","EmptyCart","map","productName","productImage","style","width","height","objectFit","borderRadius","productPrice","onClick","disabled","includes","quantity","AddToCart_Url","dismiss","increment","background","navigator","getBattery","level","loading","geolocation","getCurrentPosition","latitude","longitude","coords","address","order","Orders_Url","data","ConfirmOrder_Url","orderId","_id","userEmail","localStorage","setItem","_err$response","_err$response$data","response","msg","code","PERMISSION_DENIED"],"sourceRoot":""}