"use strict";(self.webpackChunksmilecheck=self.webpackChunksmilecheck||[]).push([[561],{561:(e,s,r)=>{r.r(s),r.d(s,{default:()=>u});var t=r(6),o=r(352),a=r(660),n=r(722),c=r(43),i=r(407),l=r(609),d=r(339),m=r(579);const _=function(){const[e]=(0,i.lT)(["token"]),[s,r]=(0,c.useState)(JSON.parse(localStorage.getItem("userLocation"))||null);return(0,m.jsxs)("div",{style:{marginTop:"20px"},children:[(0,m.jsx)("button",{onClick:()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(async s=>{try{var t;const{latitude:o,longitude:a}=s.coords,c=(null===(t=(await n.A.get("https://nominatim.openstreetmap.org/reverse?lat=".concat(o,"&lon=").concat(a,"&format=json"))).data)||void 0===t?void 0:t.display_name)||"Lat: ".concat(o,", Lng: ").concat(a);await n.A.post("http://localhost:5030/auth/location",{latitude:o,longitude:a,address:c},{headers:{Authorization:"Bearer ".concat(e.token)}});const i={latitude:o,longitude:a,address:c};r(i),localStorage.setItem("userLocation",JSON.stringify(i)),d.Ay.success("\ud83d\udccd Location saved: ".concat(c))}catch(o){console.error("Location save error:",o),d.Ay.error("Failed to fetch or save location")}},()=>d.Ay.error("\u274c Turn On Your Location access ")):d.Ay.error("Geolocation not supported!")},className:"btn btn-primary",children:"Save My Location"}),s&&(0,m.jsxs)("div",{style:{marginTop:"15px"},children:[(0,m.jsx)("h5",{children:"\ud83d\udccd Your Saved Location:"}),(0,m.jsxs)("p",{children:[(0,m.jsx)("strong",{children:"Address:"})," ",s.address,(0,m.jsx)("br",{}),(0,m.jsx)("strong",{children:"Latitude:"})," ",s.latitude,(0,m.jsx)("br",{}),(0,m.jsx)("strong",{children:"Longitude:"})," ",s.longitude]})]})]})};const u=function(){const{user:e,logout:s}=(0,t.A)(),r=(0,o.Zp)(),[d]=(0,i.lT)(["token"]),[u,p]=(0,c.useState)(0);return(0,c.useEffect)(()=>{e||r("/login")},[e,r]),(0,c.useEffect)(()=>{(async()=>{if(d.token)try{const e=await n.A.get((0,l.g3)(),{headers:{Authorization:"Bearer ".concat(d.token)}}),s=await Promise.all(e.data.map(async e=>{try{return"delivered"===(await n.A.get((0,l.NT)(e._id))).data.status?e:null}catch(s){return null}}));p(s.filter(Boolean).length)}catch(e){console.error("\u274c Error fetching delivered orders:",e)}})()},[d]),e?(0,m.jsxs)("div",{className:"my_pc_profile_12_main_wrapper",children:[(0,m.jsxs)("div",{className:"my_pc_profile_12_card",children:[(0,m.jsx)("div",{className:"my_pc_profile_12_avatar",children:(0,m.jsx)("img",{src:"https://ui-avatars.com/api/?name=".concat(e.username,"&background=6a11cb&color=fff"),alt:"Profile"})}),(0,m.jsx)("h2",{className:"my_pc_profile_12_title",children:e.username}),(0,m.jsxs)("div",{className:"my_pc_profile_12_info",children:[(0,m.jsxs)("p",{children:[(0,m.jsx)("strong",{children:"\ud83d\udce7 Email:"})," ",e.email]}),(0,m.jsxs)("p",{children:[(0,m.jsx)("strong",{children:"\ud83d\udcf1 Mobile:"})," ",e.mobile||"N/A"]})]}),(0,m.jsxs)("div",{className:"my_pc_profile_12_buttons",children:[(0,m.jsx)("button",{onClick:()=>{e&&((0,a.tC)(e.email),s())},className:"my_pc_profile_12_btn btn btn-danger logout",children:"\ud83d\udeaa Logout"}),(0,m.jsx)(o.N_,{to:"/",className:"my_pc_profile_12_btn home",children:"\ud83c\udfe0 Home"})]})]}),(0,m.jsxs)("div",{className:"my_pc_profile_12_summary",children:[(0,m.jsx)("h2",{className:"my_pc_profile_12_summary_title",children:"\ud83d\udce6 Order Summary"}),(0,m.jsxs)("div",{className:"my_pc_profile_12_summary_box",children:[(0,m.jsx)("div",{className:"my_pc_profile_12_summary_icon",children:"\u2705"}),(0,m.jsxs)("div",{className:"my_pc_profile_12_summary_text",children:[(0,m.jsx)("h3",{children:u}),(0,m.jsx)("p",{children:"Delivered Orders"})]})]}),(0,m.jsx)(o.N_,{to:"/previousorders",className:"my_pc_profile_12_summary_link",children:"\ud83d\udd0d View All Delivered Orders"})]}),(0,m.jsx)(_,{})]}):null}},660:(e,s,r)=>{r.d(s,{O1:()=>o,sZ:()=>t,tC:()=>a});const t=(0,r(104).io)("https://snapcart-usja.onrender.com",{transports:["websocket","polling"]}),o=e=>{e&&(t.emit("register",e),console.log("\ud83d\udfe2 Registered socket for:",e))},a=e=>{e&&(t.emit("unregister",e),console.log("\ud83d\udd34 Unregistered socket for:",e))}}}]);
//# sourceMappingURL=561.3af8911a.chunk.js.map