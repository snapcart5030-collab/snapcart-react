"use strict";(self.webpackChunksmilecheck=self.webpackChunksmilecheck||[]).push([[157],{157:(e,s,n)=>{n.r(s),n.d(s,{default:()=>g});var i=n(555),a=n(43),l=n(722),o=n(352),t=n(6),r=n(609),c=n(660),d=n(339),u=n(579);const g=function(){const[e,s]=(0,a.useState)({email:"",password:""}),[n,g]=(0,a.useState)(!1),m=(0,o.Zp)(),{login:p}=(0,t.A)(),h=n=>{s((0,i.A)((0,i.A)({},e),{},{[n.target.name]:n.target.value}))};return(0,u.jsx)("div",{className:"login_container_7",children:(0,u.jsxs)("div",{className:"login_card_7",children:[(0,u.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,u.jsx)(o.N_,{to:"/",className:"bi fs-2 bi-arrow-left"}),(0,u.jsx)("h2",{className:"login_title_7 bi bi-person-circle",children:"   Login"}),(0,u.jsx)("div",{})]}),(0,u.jsxs)("form",{onSubmit:async s=>{s.preventDefault(),g(!0);try{let s={latitude:null,longitude:null,address:null};await new Promise(e=>{(0,d.Ay)(s=>(0,u.jsxs)("div",{className:"",children:[(0,u.jsx)("span",{children:"Allow location access to improve your experience?"}),(0,u.jsxs)("div",{className:"d-flex justify-content-around ",children:[(0,u.jsx)("button",{onClick:()=>{d.Ay.dismiss(s.id),e(!0)},className:"btn btn-sm btn-primary",children:"Yes"}),(0,u.jsx)("button",{onClick:()=>{d.Ay.dismiss(s.id),e(!1)},className:"btn btn-sm btn-secondary",children:"No"})]})]}))})?s=await new Promise(e=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(async s=>{const n=s.coords.latitude,i=s.coords.longitude;let a=null;try{const e=await fetch("https://nominatim.openstreetmap.org/reverse?lat=".concat(n,"&lon=").concat(i,"&format=json"));a=(await e.json()).display_name||null}catch(l){console.warn("Reverse geocoding failed:",l)}e({latitude:n,longitude:i,address:a})},s=>{console.warn("Geolocation denied or failed:",s),e({latitude:null,longitude:null,address:null})},{enableHighAccuracy:!0,timeout:8e3}):e({latitude:null,longitude:null,address:null})}):(0,d.Ay)("You skipped location access.",{duration:1500});const n={email:e.email,password:e.password,latitude:s.latitude,longitude:s.longitude,address:s.address},i=await l.A.post((0,r.U7)(),n),{token:a,user:o}=i.data;p(o,a),(0,c.O1)(o.email),d.Ay.success("\u2705 Login successful!",{duration:1e3,position:"top-center"}),setTimeout(()=>m("/"),500)}catch(a){var n,i;console.error("Login error:",a),d.Ay.error((null===(n=a.response)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.msg)||"\u274c Login failed. Try again.",{duration:2500})}finally{g(!1)}},className:"login_form_7",children:[(0,u.jsxs)("div",{className:"login_input_group_7",children:[(0,u.jsx)("label",{className:"login_label_7",children:"Email"}),(0,u.jsx)("input",{type:"email",placeholder:"Enter email",className:"login_input_7",name:"email",value:e.email,onChange:h,required:!0})]}),(0,u.jsxs)("div",{className:"login_input_group_7",children:[(0,u.jsx)("label",{className:"login_label_7",children:"Password"}),(0,u.jsx)("input",{type:"password",placeholder:"Enter password",className:"login_input_7",name:"password",value:e.password,onChange:h,required:!0})]}),(0,u.jsx)("button",{id:"user_login_button_7",type:"submit",disabled:n,children:n?"Logging in...":"Login (auto location)"})]}),(0,u.jsxs)("div",{className:"link_register_go",children:[(0,u.jsx)(o.N_,{to:"/register",children:"Register"}),(0,u.jsx)("div",{className:"Link_home_go",children:(0,u.jsx)(o.N_,{to:"/",children:"Home"})})]}),(0,u.jsx)("hr",{}),(0,u.jsxs)("div",{className:"login_info_box_7",children:[(0,u.jsx)("span",{children:" Use your registered email and password to log in."}),(0,u.jsxs)("div",{children:[" Don\u2019t have an account ? ",(0,u.jsx)(o.N_,{className:"text-dark",to:"/register",children:"Register here"}),"."]})]})]})})}},660:(e,s,n)=>{n.d(s,{O1:()=>a,sZ:()=>i,tC:()=>l});const i=(0,n(104).io)("https://snapcart-usja.onrender.com",{transports:["websocket","polling"]}),a=e=>{e&&(i.emit("register",e),console.log("\ud83d\udfe2 Registered socket for:",e))},l=e=>{e&&(i.emit("unregister",e),console.log("\ud83d\udd34 Unregistered socket for:",e))}}}]);
//# sourceMappingURL=157.7da55fcb.chunk.js.map