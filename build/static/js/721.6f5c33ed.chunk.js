"use strict";(self.webpackChunksmilecheck=self.webpackChunksmilecheck||[]).push([[721],{721:(e,s,t)=>{t.r(s),t.d(s,{default:()=>h});var i=t(43),a=t(722),c=t(6),r=t(346),n=t(352),d=t(339),o=t(609),l=t(579);function u(e){let{productId:s,user:t,productName:c}=e;const[u,m]=(0,i.useState)(!1),[_,h]=(0,i.useState)(1),[p,f]=(0,i.useState)(!1),[x,v]=(0,i.useState)(""),{cartItems:y,fetchCart:j}=(0,r._)(),g=(0,n.Zp)(),b="cart-toast";(0,i.useEffect)(()=>{if("fade-out"===x){const e=setTimeout(()=>v(""),300);return()=>clearTimeout(e)}},[x]),(0,i.useEffect)(()=>{t&&(async()=>{try{const{data:e}=await a.A.get((0,o.Px)(),{headers:{Authorization:"Bearer ".concat(t.token)}}),i=e.items.find(e=>e.productId===s);m(!!i),h(i?i.quantity:1)}catch(e){m(!1),h(1)}})()},[s,t]);const N=async function(e,i){let c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!t)return d.Ay.error("Please login to manage your cart.",{position:"top-center",duration:2e3}),void g("/login");f(!0);try{await a.A.post(e,{productId:s,quantity:1},{headers:{Authorization:"Bearer ".concat(t.token)}}),h(e=>Math.max(1,e+i)),m(!c||_>1),v(c?"fade-out":"fade-in"),await j(),c?(0,d.Ay)("\ud83d\uddd1\ufe0f Item removed from cart.",{icon:"\ud83d\uded2",position:"bottom-right",duration:2e3}):d.Ay.custom(e=>{const s=(null===y||void 0===y?void 0:y.reduce((e,s)=>e+(s.quantity||0),0))+(c?0:1);return(0,l.jsx)("div",{className:"rounded-4 text-white shadow-lg px-4 py-3 flex flex-col items-center gap-2 ".concat(e.visible?"animate-slide-in":"animate-slide-out"),style:{background:"#00b761"},children:(0,l.jsxs)("button",{onClick:()=>{d.Ay.dismiss(b),g("/cart")},className:"btn p-2  fw-bold text-light px-3 py-1 text-sm",children:[(0,l.jsx)("span",{className:"",children:s})," item",s>1?"s":""," Added in cart \u2192"]})})},{id:b,position:"bottom-center",duration:3e3})}catch(u){var r,n,o;console.error((null===(r=u.response)||void 0===r?void 0:r.data)||u.message),d.Ay.error((null===(n=u.response)||void 0===n||null===(o=n.data)||void 0===o?void 0:o.msg)||"Cart update failed",{position:"bottom-right",duration:2e3})}finally{setTimeout(()=>f(!1),400)}};return(0,l.jsx)("div",{className:"buttonpage-container",children:u?(0,l.jsxs)("div",{className:"button-group ".concat(x),children:[(0,l.jsx)("button",{onClick:()=>1===_?N((0,o.t8)(),-1,!0):N((0,o.t8)(),-1),id:"minus_button",className:"bi ".concat(1===_?"bi-trash-fill":"bi-dash-lg"),disabled:p}),(0,l.jsxs)("div",{className:"count-wrapper",children:[p&&(0,l.jsx)("div",{className:"spin-circle"}),(0,l.jsx)("span",{className:"count-text",children:_})]}),(0,l.jsx)("button",{onClick:()=>N((0,o.d8)(),1),id:"plus_button",className:"bi bi-plus-lg",disabled:p})]}):(0,l.jsx)("button",{id:"addtocart_button",onClick:()=>N((0,o.d8)(),0),className:"add-button ".concat("fade-out"===x?"fade-in":""),disabled:p,children:p?(0,l.jsx)("span",{style:{fontSize:"15px"},children:"Adding"}):"Add"})})}const m=function(){const e=Array(30).fill(0),[s,t]=(0,i.useState)(""),[a,c]=(0,i.useState)("");return(0,i.useEffect)(()=>{const e=setTimeout(()=>{t("Loading..")},2500);return()=>clearTimeout(e)},[]),(0,i.useEffect)(()=>{const e=setTimeout(()=>{t(""),c("Check Network Connection ! ")},4e3);return()=>clearTimeout(e)},[]),(0,l.jsx)("div",{id:"shop_wrappscroll",className:"",children:(0,l.jsx)("div",{className:"row g-2",children:e.map((e,t)=>(0,l.jsx)("div",{className:"col-4 col-sm-3 col-md-2",id:"card_boxscroll",children:(0,l.jsxs)("div",{id:"shimmer_card",children:[(0,l.jsx)("div",{id:"shimmer_img",children:(0,l.jsxs)("div",{id:"loading_text_cards",className:"mt-4 py-1",children:[s,(0,l.jsx)("span",{style:{fontSize:"9px"},children:a})]})}),(0,l.jsx)("div",{id:"shimmer_title"}),(0,l.jsx)("div",{id:"shimmer_rating"}),(0,l.jsx)("div",{id:"shimmer_price"}),(0,l.jsxs)("div",{id:"shimmer_desc",children:[(0,l.jsx)("div",{id:"shimmer_line"}),(0,l.jsx)("div",{id:"shimmer_line"})]})]})},t))})})};var _=t(47);function h(e){var s;let{category:t}=e;const{user:r}=(0,c.A)(),[d,u]=(0,i.useState)([]),[h,f]=(0,i.useState)([]),[x,v]=(0,i.useState)("All"),[y,j]=(0,i.useState)(!0),[g,b]=(0,i.useState)(!1);null===(s=(0,n.zy)().state)||void 0===s||s.subcategory;(0,i.useEffect)(()=>{(async()=>{try{const e=await a.A.get("".concat((0,o.IC)(),"/").concat(t)),s=await a.A.get("".concat((0,o.IC)(),"/").concat(t,"/subcategories"));u(e.data.subcategories||[]),f(s.data.subcategories||[])}catch(e){console.error("Error fetching category data:",e),u([]),f([])}finally{j(!1)}})()},[t]),(0,i.useEffect)(()=>{const e=()=>{window.scrollY>100?b(!0):b(!1)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]);const N="All"===x?d:d.filter(e=>e.name.toLowerCase()===x.toLowerCase());return y?(0,l.jsxs)("div",{className:"my_fruits_loading_11",children:[" ",(0,l.jsx)(_.A,{})," "]}):(0,l.jsxs)("div",{className:"my_fruits_container_11 container-fluid",children:[(0,l.jsx)("div",{className:"my_fruits_subcat_list_11 ".concat(g?"sticky-bar":""),children:y?(0,l.jsx)("div",{className:"my_fruits_subcat_shimmer_11",children:[...Array(6)].map((e,s)=>(0,l.jsx)("div",{className:"my_fruits_subcat_shimmer_item_11"},s))}):(0,l.jsx)("div",{className:"my_fruits_subcat_scroll_11",children:["All",...h.map(e=>e.name)].map(e=>(0,l.jsx)("span",{onClick:()=>v(e),className:"my_fruits_subcat_item_11 ms-2 ".concat(x===e?"active":""),children:e},e))})}),N.map(e=>{var s;return(0,l.jsxs)("div",{className:"my_fruits_section_11",children:["All"===x&&(0,l.jsx)("h2",{className:"my_fruits_title_11",children:e.name}),(0,l.jsx)("div",{className:"my_fruits_grid_11",children:null===(s=e.products)||void 0===s?void 0:s.map(e=>(0,l.jsx)(p,{p:e,user:r},e._id))})]},e.name)}),!N.length&&(0,l.jsx)("div",{className:"my_fruits_empty_11",children:(0,l.jsx)(m,{})})]})}function p(e){let{p:s,user:t}=e;const[a,c]=(0,i.useState)(!1);return(0,l.jsxs)("div",{className:"my_fruits_card_11",children:[(0,l.jsxs)("div",{className:"my_fruits_img_wrapper_11",children:[!a&&(0,l.jsx)("div",{className:"my_fruits_img_shimmer_11"}),(0,l.jsx)("img",{src:s.productImage,alt:s.productName,onLoad:()=>c(!0),onError:()=>console.warn("Image failed to load:",s.productImage),className:"my_fruits_img_11 ".concat(a?"visible":"hidden")})]}),(0,l.jsx)("h4",{className:"my_fruits_name_11",children:s.productName}),(0,l.jsxs)("div",{className:"d-flex justify-content-around",children:[(0,l.jsxs)("del",{className:"my_fruits_price_11 text-danger",children:["\u20b9",s.productPrice+20]}),(0,l.jsxs)("p",{className:"my_fruits_price_11",children:["\u20b9",s.productPrice]})]}),(0,l.jsx)(u,{productName:s.productName,productId:s._id,user:t}),(0,l.jsx)("p",{className:"my_fruits_disc_11 bi bi-tag-fill",children:s.productDisc})]})}}}]);
//# sourceMappingURL=721.6f5c33ed.chunk.js.map